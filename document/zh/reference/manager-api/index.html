<!DOCTYPE html><html lang="zh-CN" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-aol2lm4u"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>全局 API | Danmu 💬</title><link rel="canonical"/><link rel="shortcut icon" href="/danmu/document/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v4.14.2"/><meta name="generator" content="Starlight v0.25.2"/><meta property="og:title" content="全局 API"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="zh-CN"/><meta property="og:description" content="学习 manager 实例上的 api"/><meta property="og:site_name" content="Danmu 💬"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="全局 API"/><meta name="twitter:description" content="学习 manager 实例上的 api"/><meta name="description" content="学习 manager 实例上的 api"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/danmu/document/_astro/index.DGHkAK-c.css">
<style>:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-wmftcrhb){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-wmftcrhb){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-wmftcrhb){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-wmftcrhb){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-wmftcrhb){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-wmftcrhb){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-wmftcrhb){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-wmftcrhb){vertical-align:middle}
.card-grid:where(.astro-ljvzjda6){display:grid;gap:1rem}.card-grid:where(.astro-ljvzjda6)>*{margin-top:0!important}@media (min-width: 50rem){.card-grid:where(.astro-ljvzjda6){grid-template-columns:1fr 1fr;gap:1.5rem}.stagger:where(.astro-ljvzjda6){--stagger-height: 5rem;padding-bottom:var(--stagger-height)}.stagger:where(.astro-ljvzjda6)>*:nth-child(2n){transform:translateY(var(--stagger-height))}}
.card:where(.astro-j3lb4qfl){--sl-card-border: var(--sl-color-purple);--sl-card-bg: var(--sl-color-purple-low);border:1px solid var(--sl-color-gray-5);background-color:var(--sl-color-black);padding:clamp(1rem,calc(.125rem + 3vw),2.5rem);flex-direction:column;gap:clamp(.5rem,calc(.125rem + 1vw),1rem)}.card:where(.astro-j3lb4qfl):nth-child(4n+1){--sl-card-border: var(--sl-color-orange);--sl-card-bg: var(--sl-color-orange-low)}.card:where(.astro-j3lb4qfl):nth-child(4n+3){--sl-card-border: var(--sl-color-green);--sl-card-bg: var(--sl-color-green-low)}.card:where(.astro-j3lb4qfl):nth-child(4n+4){--sl-card-border: var(--sl-color-red);--sl-card-bg: var(--sl-color-red-low)}.card:where(.astro-j3lb4qfl):nth-child(4n+5){--sl-card-border: var(--sl-color-blue);--sl-card-bg: var(--sl-color-blue-low)}.title:where(.astro-j3lb4qfl){font-weight:600;font-size:var(--sl-text-h4);color:var(--sl-color-white);line-height:var(--sl-line-height-headings);gap:1rem;align-items:center}.card:where(.astro-j3lb4qfl) .icon:where(.astro-j3lb4qfl){border:1px solid var(--sl-card-border);background-color:var(--sl-card-bg);padding:.2em;border-radius:.25rem}.card:where(.astro-j3lb4qfl) .body:where(.astro-j3lb4qfl){margin:0;font-size:clamp(var(--sl-text-sm),calc(.5rem + 1vw),var(--sl-text-body))}
svg:where(.astro-faayp7c7){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
starlight-tabs:where(.astro-bmm4ev37){display:block}.tablist-wrapper:where(.astro-bmm4ev37){overflow-x:auto}:where(.astro-bmm4ev37)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-bmm4ev37){margin-bottom:-2px}.tab:where(.astro-bmm4ev37)>:where(.astro-bmm4ev37)[role=tab]{display:flex;align-items:center;gap:.5rem;padding:0 1.25rem;text-decoration:none;border-bottom:2px solid var(--sl-color-gray-5);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-bmm4ev37) :where(.astro-bmm4ev37)[role=tab][aria-selected=true]{color:var(--sl-color-white);border-color:var(--sl-color-text-accent);font-weight:600}.tablist-wrapper:where(.astro-bmm4ev37)~[role=tabpanel]{margin-top:1rem}
.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:not(:last-of-type):after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}
</style><script type="module" src="/danmu/document/_astro/hoisted.DZrKgEha.js"></script>
<script type="module" src="/danmu/document/_astro/page.LS5KDvwX.js"></script></head> <body class="astro-aol2lm4u"> <a href="#_top" class="astro-4l5pqjei">跳转到内容</a>  <div class="page sl-flex astro-wux7kjlj"> <header class="header astro-wux7kjlj"><div class="header sl-flex astro-jxyvw2is"> <div class="title-wrapper sl-flex astro-jxyvw2is"> <a href="/danmu/document/zh" class="site-title sl-flex astro-ddvaprui">  <span class="astro-ddvaprui"> Danmu 💬 </span> </a>  </div> <div class="sl-flex astro-jxyvw2is"> <site-search data-translations="{&#34;placeholder&#34;:&#34;搜索&#34;}" class="astro-fo6yzsaj"> <button data-open-modal disabled aria-label="搜索" aria-keyshortcuts="Control+K" class="astro-fo6yzsaj"> <svg aria-hidden="true" class="astro-fo6yzsaj astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-fo6yzsaj" aria-hidden="true">搜索</span> <kbd class="sl-hidden md:sl-flex astro-fo6yzsaj" style="display: none;"> <kbd class="astro-fo6yzsaj">Ctrl</kbd><kbd class="astro-fo6yzsaj">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="搜索" class="astro-fo6yzsaj"> <div class="dialog-frame sl-flex astro-fo6yzsaj">  <button data-close-modal class="sl-flex md:sl-hidden astro-fo6yzsaj"> 取消 </button> <div class="search-container astro-fo6yzsaj"> <div id="starlight__search" class="astro-fo6yzsaj"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = '⌘';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script>    </div> <div class="sl-hidden md:sl-flex right-group astro-jxyvw2is"> <div class="sl-flex social-icons astro-jxyvw2is"> <a href="https://github.com/imtaotao/danmu" rel="me" class="sl-flex astro-btu3ee4b"><span class="sr-only astro-btu3ee4b">GitHub</span><svg aria-hidden="true" class="astro-btu3ee4b astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-rapide-theme-select class="astro-cixw272k"> <button aria-label="选择主题" aria-live="polite" class="sl-flex astro-cixw272k" title="选择主题"> <svg aria-hidden="true" height="16" viewBox="0 0 24 24" width="16" class="astro-cixw272k"> <mask class="moon astro-cixw272k" id="moon-mask-b9108517"> <rect x="0" y="0" width="100%" height="100%" fill="white" class="astro-cixw272k"></rect> <circle cx="24" cy="10" r="6" fill="black" class="astro-cixw272k"></circle> </mask> <circle class="sun astro-cixw272k" cx="12" cy="12" r="6" mask="url(#moon-mask-b9108517)"></circle> <g class="sun-beams astro-cixw272k" stroke="currentColor"> <line x1="12" y1="1" x2="12" y2="3" class="astro-cixw272k"></line> <line x1="12" y1="21" x2="12" y2="23" class="astro-cixw272k"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" class="astro-cixw272k"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" class="astro-cixw272k"></line> <line x1="1" y1="12" x2="3" y2="12" class="astro-cixw272k"></line> <line x1="21" y1="12" x2="23" y2="12" class="astro-cixw272k"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" class="astro-cixw272k"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" class="astro-cixw272k"></line> </g> </svg> </button> </starlight-rapide-theme-select>   <script>
  StarlightThemeProvider.updatePickers()
</script>   </div> </div> </header> <nav class="sidebar astro-wux7kjlj" aria-label="主要"> <starlight-menu-button class="astro-y4v5aabs"> <button aria-expanded="false" aria-label="菜单" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-y4v5aabs"> <svg aria-hidden="true" class="astro-y4v5aabs astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-wux7kjlj"> <div class="sidebar-content sl-flex astro-wux7kjlj"> <ul class="top-level astro-4pal5kq2"> <li class="astro-4pal5kq2"> <details open class="astro-4pal5kq2"> <summary class="astro-4pal5kq2"> <div class="group-label astro-4pal5kq2"> <span class="large astro-4pal5kq2">指南</span>  </div> <svg aria-hidden="true" class="caret astro-4pal5kq2 astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-4pal5kq2"> <li class="astro-4pal5kq2"> <a href="/danmu/document/zh/guide/getting-started/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">快速入门</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/guide/typescript-interface/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">TypeScript 类型</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/guide/create-plugin/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">编写插件</span>  </a> </li> </ul>  </details> </li><li class="astro-4pal5kq2"> <details open class="astro-4pal5kq2"> <summary class="astro-4pal5kq2"> <div class="group-label astro-4pal5kq2"> <span class="large astro-4pal5kq2">参考</span>  </div> <svg aria-hidden="true" class="caret astro-4pal5kq2 astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-4pal5kq2"> <li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">概览</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/manager-config/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">全局配置</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/manager-hooks/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">全局钩子</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/manager-api/" aria-current="page" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">全局 API</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/danmaku-hooks/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">弹幕钩子</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/reference/danmaku-api/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">弹幕 API</span>  </a> </li> </ul>  </details> </li><li class="astro-4pal5kq2"> <details open class="astro-4pal5kq2"> <summary class="astro-4pal5kq2"> <div class="group-label astro-4pal5kq2"> <span class="large astro-4pal5kq2">常见场景</span>  </div> <svg aria-hidden="true" class="caret astro-4pal5kq2 astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-4pal5kq2"> <li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/cooldown/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">冷却时间</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/lite/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">弹幕精简模式</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/keyword/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">过滤关键字</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/like/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">点赞/点踩</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/style-danmaku/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">自定义弹幕样式</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/style-container/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">自定义容器样式</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/image/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">发送带图片的弹幕</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/loop/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">发送循环弹幕</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/fixed/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">固定弹幕在顶部</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/anti-occlusion/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">防遮挡功能的实现</span>  </a> </li><li class="astro-4pal5kq2"> <a href="/danmu/document/zh/case/track/" class="astro-4pal5kq2"> <span class="astro-4pal5kq2">控制轨道数量和渲染</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-ibmelhcd"> <div class="sl-flex social-icons astro-ibmelhcd"> <a href="https://github.com/imtaotao/danmu" rel="me" class="sl-flex astro-btu3ee4b"><span class="sr-only astro-btu3ee4b">GitHub</span><svg aria-hidden="true" class="astro-btu3ee4b astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-rapide-theme-select class="astro-cixw272k"> <button aria-label="选择主题" aria-live="polite" class="sl-flex astro-cixw272k" title="选择主题"> <svg aria-hidden="true" height="16" viewBox="0 0 24 24" width="16" class="astro-cixw272k"> <mask class="moon astro-cixw272k" id="moon-mask-f4d3558b"> <rect x="0" y="0" width="100%" height="100%" fill="white" class="astro-cixw272k"></rect> <circle cx="24" cy="10" r="6" fill="black" class="astro-cixw272k"></circle> </mask> <circle class="sun astro-cixw272k" cx="12" cy="12" r="6" mask="url(#moon-mask-f4d3558b)"></circle> <g class="sun-beams astro-cixw272k" stroke="currentColor"> <line x1="12" y1="1" x2="12" y2="3" class="astro-cixw272k"></line> <line x1="12" y1="21" x2="12" y2="23" class="astro-cixw272k"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" class="astro-cixw272k"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" class="astro-cixw272k"></line> <line x1="1" y1="12" x2="3" y2="12" class="astro-cixw272k"></line> <line x1="21" y1="12" x2="23" y2="12" class="astro-cixw272k"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" class="astro-cixw272k"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" class="astro-cixw272k"></line> </g> </svg> </button> </starlight-rapide-theme-select>   <script>
  StarlightThemeProvider.updatePickers()
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-wux7kjlj">  <div class="lg:sl-flex astro-cccrfebb"> <aside class="right-sidebar-container astro-cccrfebb"> <div class="right-sidebar astro-cccrfebb"> <div class="lg:sl-hidden astro-miu5wawz"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-yycdddcs"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-yycdddcs"><details id="starlight__mobile-toc" class="astro-yycdddcs"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-yycdddcs"><div class="toggle sl-flex astro-yycdddcs">本页内容<svg aria-hidden="true" class="caret astro-yycdddcs astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-yycdddcs"></span></summary><div class="dropdown astro-yycdddcs"><ul class="isMobile astro-slvwvpa3" style="--depth: 0;"> <li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#_top" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">概述</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#属性" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">属性</span> </a> <ul class="isMobile astro-slvwvpa3" style="--depth: 1;"> <li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#version" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">version</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#options" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">options</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#statuses" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">statuses</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#container" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">container</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#trackcount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">trackCount</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#pluginsystem" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">pluginSystem</span> </a>  </li> </ul>  </li><li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#方法" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">方法</span> </a> <ul class="isMobile astro-slvwvpa3" style="--depth: 1;"> <li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#canpush" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">canPush()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#push" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">push()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#unshift" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">unshift()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#pushflexibledanmaku" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">pushFlexibleDanmaku()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#gettracklocation" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">getTrackLocation()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#cleartarck" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">clearTarck()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#len" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">len()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#each" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">each()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#asynceach" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">asyncEach()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#mount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">mount()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#unmount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">unmount()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#clear" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">clear()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#updateoptions" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">updateOptions()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#startplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">startPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#stopplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">stopPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#hide" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">hide()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#show" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">show()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#nextframe" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">nextFrame()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#updateoccludedurl" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">updateOccludedUrl()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#render" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">render()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#remove" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">remove()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#use" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">use()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isshow" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isShow()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isfreeze" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isFreeze()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isdanmaku" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isDanmaku()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setarea" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setArea()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setopacity" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setOpacity()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setstyle" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setStyle()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setrate" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setRate()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setmode" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setMode()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setgap" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setGap()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#settimes" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setTimes()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setlimits" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setLimits()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setinterval" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setInterval()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setdirection" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setDirection()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#settrackheight" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setTrackHeight()</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-miu5wawz"><div class="sl-container astro-miu5wawz"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">本页内容</h2><ul class="astro-slvwvpa3" style="--depth: 0;"> <li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#_top" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">概述</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#属性" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">属性</span> </a> <ul class="astro-slvwvpa3" style="--depth: 1;"> <li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#version" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">version</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#options" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">options</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#statuses" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">statuses</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#container" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">container</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#trackcount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">trackCount</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#pluginsystem" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">pluginSystem</span> </a>  </li> </ul>  </li><li class="astro-slvwvpa3" style="--depth: 0;"> <a href="#方法" class="astro-slvwvpa3" style="--depth: 0;"> <span class="astro-slvwvpa3" style="--depth: 0;">方法</span> </a> <ul class="astro-slvwvpa3" style="--depth: 1;"> <li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#canpush" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">canPush()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#push" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">push()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#unshift" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">unshift()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#pushflexibledanmaku" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">pushFlexibleDanmaku()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#gettracklocation" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">getTrackLocation()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#cleartarck" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">clearTarck()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#len" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">len()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#each" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">each()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#asynceach" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">asyncEach()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#mount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">mount()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#unmount" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">unmount()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#clear" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">clear()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#updateoptions" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">updateOptions()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#startplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">startPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#stopplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">stopPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#hide" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">hide()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#show" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">show()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#nextframe" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">nextFrame()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#updateoccludedurl" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">updateOccludedUrl()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#render" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">render()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#remove" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">remove()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#use" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">use()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isshow" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isShow()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isfreeze" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isFreeze()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isplaying" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isPlaying()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#isdanmaku" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">isDanmaku()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setarea" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setArea()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setopacity" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setOpacity()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setstyle" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setStyle()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setrate" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setRate()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setmode" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setMode()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setgap" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setGap()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#settimes" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setTimes()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setlimits" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setLimits()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setinterval" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setInterval()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#setdirection" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setDirection()</span> </a>  </li><li class="astro-slvwvpa3" style="--depth: 1;"> <a href="#settrackheight" class="astro-slvwvpa3" style="--depth: 1;"> <span class="astro-slvwvpa3" style="--depth: 1;">setTrackHeight()</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-cccrfebb">  <main data-pagefind-body lang="zh-CN" dir="ltr" class="astro-aol2lm4u">    <div class="content-panel astro-o6hgtf4y"> <div class="sl-container astro-o6hgtf4y">  <h1 id="_top" class="astro-fnywlgwl">全局 API</h1>  </div> </div>  <div class="content-panel astro-o6hgtf4y"> <div class="sl-container astro-o6hgtf4y"> <div class="sl-markdown-content"> <aside aria-label="单位提示" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>单位提示</p><section class="starlight-aside__content"><p><code dir="auto">danmu</code> 所有参与计算的单位都允许通过表达式来计算，类似 CSS 的 <code dir="auto">calc</code>。</p><ol>
<li><code dir="auto">number</code>: 默认单位为 <code dir="auto">px</code>。</li>
<li><code dir="auto">string</code>: 表达式计算。支持（<code dir="auto">+</code>, <code dir="auto">-</code>, <code dir="auto">*</code>, <code dir="auto">/</code>）数学计算，只支持 <code dir="auto">%</code> 和 <code dir="auto">px</code> 两种单位。</li>
</ol><div class="expressive-code"><link rel="stylesheet" href="/danmu/document/_astro/ec.e0ij3.css"><script type="module" src="/danmu/document/_astro/ec.3zb7u.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">setGap</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">(100% - 10px) / 5</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="manager.setGap(&#x27;(100% - 10px) / 5&#x27;);"><div></div></button></div></figure></div></section></aside>
<h2 id="属性">属性</h2>
<h3 id="version"><code dir="auto">version</code></h3>
<p><strong>类型：<code dir="auto">string</code></strong></p>
<p><code dir="auto">danmu</code> npm 包的版本。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="options"><code dir="auto">options</code></h3>
<p><strong>类型：<code dir="auto">ManagerOptions</code></strong></p>
<p><code dir="auto">manager</code> 的 <a href="../manager-config"><strong><code dir="auto">options</code></strong></a>，你可以从这里取到一些初始值并使用。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">console</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">log</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">options</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">times</span><span style="--0:#8B8B8B;--1:#686868">);</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#818F81FE;--1:#636B63">// [number, number]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="console.log(manager.options.times); // [number, number]"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="statuses"><code dir="auto">statuses</code></h3>
<p><strong>类型：<code dir="auto">Record&#x3C;PropertyKey, unknown></code></strong></p>
<p>一个记录状态的属性，在内核中没有使用，主要是提供给业务方记录一些状态使用的。默认类型为一个 <code dir="auto">Record&#x3C;PropertyKey, unknown></code>，不过你可以在创建 <code dir="auto">manager</code> 的时候传递范型。</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">init.ts</span></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#55987B;--1:#1E754F">import</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#BD976A;--1:#876037">create</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#55987B;--1:#1E754F">from</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">danmu</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight mark"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#80A665;--1:#4B7231">create</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">unknown</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">background</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> }>();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">statuses</span><span style="--0:#8B8B8B;--1:#686868">;</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#818F81FE;--1:#636B63">// 类型为 { background: string }</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { create } from &#x27;danmu&#x27;;const manager = create<unknown, { background: string }>();manager.statuses; // 类型为 { background: string }"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="container"><code dir="auto">container</code></h3>
<p><strong>类型：<code dir="auto">Container</code></strong></p>
<p>弹幕容器实例，其上面有如下公共方法供使用，当你在一些钩子里面获取到 container 实例时，可以参考本小节的知识。</p>
<aside aria-label="注意事项" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>注意事项</p><section class="starlight-aside__content"><p>如果你需要对容器的宽高做更改，建议使用 <code dir="auto">manager.setArea()</code> 方法，而不要通过 <code dir="auto">manager.container.setStyle()</code> 来更改，否则你需要手动调用 <code dir="auto">manager.format()</code>。</p></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">declare</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#CB7676;--1:#9E5252">class</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">Container</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// 容器的宽度</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">width</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// 容器的高度</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">height</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// 容器的节点</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">node</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">HTMLDivElement</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// 容器的父节点，通过 manager.mount() 设置后，可以通过此属性拿到</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">parentNode</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">HTMLElement</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#CB7676;--1:#9E5252">null</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// 设置容器节点的样式</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#80A665;--1:#4B7231">setStyle</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#CB7676;--1:#9E5252">extends</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">StyleKey</span><span style="--0:#8B8B8B;--1:#686868">>(</span><span style="--0:#BD976A;--1:#876037">key</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#BD976A;--1:#876037">val</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">CSSStyleDeclaration</span><span style="--0:#8B8B8B;--1:#686868">[</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">]):</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">void</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 所以你可以以下方式来给容器设置一些样式</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">setStyle</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">background</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">red</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="declare class Container {  // 容器的宽度  width: number;  // 容器的高度  height: number;  // 容器的节点  node: HTMLDivElement;  // 容器的父节点，通过 manager.mount() 设置后，可以通过此属性拿到  parentNode: HTMLElement | null;  // 设置容器节点的样式  setStyle<T extends StyleKey>(key: T, val: CSSStyleDeclaration[T]): void;}// 所以你可以以下方式来给容器设置一些样式manager.container.setStyle(&#x27;background&#x27;, &#x27;red&#x27;);"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="trackcount"><code dir="auto">trackCount</code></h3>
<p><strong>类型：<code dir="auto">number</code></strong></p>
<p>当前容器内部轨道的数量。当容器的大小改变后，并且 <code dir="auto">format</code> 之后（你手动调用 <code dir="auto">format()</code> 方法或者调用 <code dir="auto">setArea()</code> 方法），<code dir="auto">trackCount</code> 也会随之改变。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="pluginsystem"><code dir="auto">pluginSystem</code></h3>
<p><strong>类型：<code dir="auto">PluginSystem</code></strong></p>
<p><code dir="auto">manager</code> 的插件系统实例，其 api 可以见 <a href="https://github.com/imtaotao/hooks-plugin?tab=readme-ov-file#apis"><strong>hooks-plugin</strong></a> 的文档。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h2 id="方法">方法</h2>
<h3 id="canpush"><code dir="auto">canPush()</code></h3>
<p><strong>类型：<code dir="auto">(type: DanmakuType) => boolean</code></strong></p>
<p>判断是否能够添加弹幕，超过内存限制阈值，渲染数量阈值会被阻止添加，你可以通过调用 <code dir="auto">manager.setLimits()</code> 来更改。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 判断当前能否 push 一个普通弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">canPush</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">facile</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 判断当前能否 push 一个高级弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">canPush</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">flexible</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// 判断当前能否 push 一个普通弹幕manager.canPush(&#x27;facile&#x27;);// 判断当前能否 push 一个高级弹幕manager.canPush(&#x27;flexible&#x27;);"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="push"><code dir="auto">push()</code></h3>
<p><strong>类型：<code dir="auto">(data: T, options?: PushOptions&#x3C;T>) => boolean</code></strong></p>
<p>发送一条弹幕，这条弹幕会被放在内存数组中等待被渲染，这不一定是即时响应渲染的，要看你设置的渲染算法，你可以通过调用 <code dir="auto">manager.setMode()</code> 来更改，会触发 <code dir="auto">push</code> 钩子。</p>
<aside aria-label="注意" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>注意</p><section class="starlight-aside__content"><ol>
<li>发送弹幕的时候，<strong>数据格式必须是 <code dir="auto">T</code></strong>，至于 <code dir="auto">T</code> 的类型由你自己来控制，只要你能在渲染的时候能正确拿到就可以了，具体见下面的示例。</li>
<li>当第二个参数没有传递时，或者其中某些参数没有传递时，则会从 <code dir="auto">manager.options</code> 里面取默认的值。</li>
</ol></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#55987B;--1:#1E754F">export</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#CB7676;--1:#9E5252">interface</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">PushOptions</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">></span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">id</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">rate</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">duration</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">DanmakuPlugin</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">>;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">direction</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">right</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">left</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="export interface PushOptions<T> {  id?: number | string;  rate?: number;  duration?: number;  plugin?: DanmakuPlugin<T>;  direction?: &#x27;right&#x27; | &#x27;left&#x27;;}"><div></div></button></div></figure></div>
<p><strong>简单 case：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#55987B;--1:#1E754F">import</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#BD976A;--1:#876037">create</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#55987B;--1:#1E754F">from</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">danmu</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#80A665;--1:#4B7231">create</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868">>();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 发送一条弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 时间，速率，方向等配置复用全局的也就是 create() 时传递的参数。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">push</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">弹幕内容</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { create } from &#x27;danmu&#x27;;const manager = create<string>();// 发送一条弹幕// 时间，速率，方向等配置复用全局的也就是 create() 时传递的参数。manager.push(&#x27;弹幕内容&#x27;);"><div></div></button></div></figure></div>
<p><strong>完整 case：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#55987B;--1:#1E754F">import</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#BD976A;--1:#876037">create</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#55987B;--1:#1E754F">from</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">danmu</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#80A665;--1:#4B7231">create</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">content</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> }>();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 发送一条弹幕并添加插件处理，插件的作用域仅限当前 push 的这一条弹幕。</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">push</span><span style="--0:#8B8B8B;--1:#686868">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8B8B8B;--1:#686868">{ </span><span style="--0:#B8A965;--1:#786713">content</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">弹幕内容</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868"> },</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">id</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#4C9A91;--1:#2C7181">1</span><span style="--0:#8B8B8B;--1:#686868">, </span><span style="--0:#818F81FE;--1:#636B63">// 如果你的弹幕有 id，可以添加到这里</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">rate</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#4C9A91;--1:#2C7181">1.5</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">duration</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#4C9A91;--1:#2C7181">1000</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">direction</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">left</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">plugin</span><span style="--0:#8B8B8B;--1:#686868">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#80A665;--1:#4B7231">createNode</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">div</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">document</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">createElement</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">div</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#BD976A;--1:#876037">div</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">innerHTML</span><span style="--0:#8B8B8B;--1:#686868"> = </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">data</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">content</span><span style="--0:#8B8B8B;--1:#686868">; </span><span style="--0:#818F81FE;--1:#636B63">// 弹幕内容</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">node</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">appendChild</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">div</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">      </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">    </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">  </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { create } from &#x27;danmu&#x27;;const manager = create<{ content: string }>();// 发送一条弹幕并添加插件处理，插件的作用域仅限当前 push 的这一条弹幕。manager.push(  { content: &#x27;弹幕内容&#x27; },  {    id: 1, // 如果你的弹幕有 id，可以添加到这里    rate: 1.5,    duration: 1000,    direction: &#x27;left&#x27;,    plugin: {      createNode(danmaku) {        const div = document.createElement(&#x27;div&#x27;);        div.innerHTML = danmaku.data.content; // 弹幕内容        danmaku.node.appendChild(div);      },    },  },);"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="unshift"><code dir="auto">unshift()</code></h3>
<p><strong>类型：<code dir="auto">(data: T, options?: PushOptions&#x3C;T>) => boolean</code></strong></p>
<p><code dir="auto">push</code> 方法是添加到内存数组后面，此方法会将弹幕<strong>添加到内存数组前面</strong>，当用户在输入了一条弹幕点击发送的时候，你应该使用此方法，以便于让弹幕在下次轮询的时候<strong>立即渲染</strong>，用法和 <code dir="auto">push</code> 方法一样，会触发 <code dir="auto">push</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="pushflexibledanmaku"><code dir="auto">pushFlexibleDanmaku()</code></h3>
<p><strong>类型：<code dir="auto">(data: T, options?: PushFlexOptions&#x3C;T>) => boolean</code></strong></p>
<p>发送一条高级弹幕，<strong>高级弹幕会在下次轮询的时候渲染</strong>，会触发 <code dir="auto">push</code> 钩子。</p>
<aside aria-label="高级弹幕说明" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>高级弹幕说明</p><section class="starlight-aside__content"><ol>
<li>高级弹幕的 <code dir="auto">options</code> 和普通弹幕的 <code dir="auto">options</code> 行为一样，如果不传会默认从 <code dir="auto">manager.options</code> 里面取默认值。</li>
<li>高级弹幕<strong>必须传递 <code dir="auto">position</code> 来指定位置</strong>，如果需要指定在某个轨道渲染，可以借助 <a href="./#gettracklocation"><strong><code dir="auto">getTrackLocation()</code></strong></a> 来做到。</li>
</ol></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#55987B;--1:#1E754F">import</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#BD976A;--1:#876037">create</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#55987B;--1:#1E754F">from</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">danmu</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">interface</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">Position</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">x</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">y</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">interface</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">PushFlexOptions</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">id</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">rate</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">duration</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">DanmakuPlugin</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">>;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">direction</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">left</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">right</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">none</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">;</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#818F81FE;--1:#636B63">// 普通弹幕没有 'none'</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">position</span><span style="--0:#8B8B8B;--1:#686868">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">    </span></span><span style="--0:#8B8B8B;--1:#686868">| </span><span style="--0:#5DA994;--1:#25746A">Position</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">    </span></span><span style="--0:#8B8B8B;--1:#686868">| ((</span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">Danmaku</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">T</span><span style="--0:#8B8B8B;--1:#686868">>, </span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">Container</span><span style="--0:#8B8B8B;--1:#686868">) => </span><span style="--0:#5DA994;--1:#25746A">Position</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#80A665;--1:#4B7231">create</span><span style="--0:#8B8B8B;--1:#686868">&#x3C;</span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868">>();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 发送一条弹幕，在容器居中的位置，静止 5s</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">pushFlexibleDanmaku</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">弹幕内容</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#B8A965;--1:#786713">duration</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#4C9A91;--1:#2C7181">5000</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#B8A965;--1:#786713">direction</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">none</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#80A665;--1:#4B7231">position</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">, </span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#818F81FE;--1:#636B63">// 也可以通过字符串表达式来设置 `50% - (${danmaku.getWidth()} / 2)`</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#55987B;--1:#1E754F">return</span><span style="--0:#8B8B8B;--1:#686868"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#B8A965;--1:#786713">x</span><span style="--0:#8B8B8B;--1:#686868">: (</span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">width</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getWidth</span><span style="--0:#8B8B8B;--1:#686868">()) </span><span style="--0:#CB7676;--1:#9E5252">*</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#4C9A91;--1:#2C7181">0.5</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#B8A965;--1:#786713">y</span><span style="--0:#8B8B8B;--1:#686868">: (</span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">height</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getHeight</span><span style="--0:#8B8B8B;--1:#686868">()) </span><span style="--0:#CB7676;--1:#9E5252">*</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#4C9A91;--1:#2C7181">0.5</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">    </span></span><span style="--0:#8B8B8B;--1:#686868">};</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">  </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">});</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import { create } from &#x27;danmu&#x27;;interface Position {  x: number;  y: number;}interface PushFlexOptions {  id?: number | string;  rate?: number;  duration?: number;  plugin?: DanmakuPlugin<T>;  direction?: &#x27;left&#x27; | &#x27;right&#x27; | &#x27;none&#x27;; // 普通弹幕没有 &#x27;none&#x27;  position:    | Position    | ((danmaku: Danmaku<T>, container: Container) => Position);}const manager = create<string>();// 发送一条弹幕，在容器居中的位置，静止 5smanager.pushFlexibleDanmaku(&#x27;弹幕内容&#x27;, {  duration: 5000,  direction: &#x27;none&#x27;,  position(danmaku, container) {    // 也可以通过字符串表达式来设置 &#x60;50% - (${danmaku.getWidth()} / 2)&#x60;    return {      x: (container.width - danmaku.getWidth()) * 0.5,      y: (container.height - danmaku.getHeight()) * 0.5,    };  },});"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="gettracklocation"><code dir="auto">getTrackLocation()</code></h3>
<p><strong>类型：<code dir="auto">(i: number) => { start: number, middle: number, end: number }</code></strong></p>
<p>用来获取某条轨道的位置信息，<strong>单位为 <code dir="auto">px</code>，为 Y 轴的数据</strong>。<strong><code dir="auto">i</code> 如果为正整数，则是取的是 <code dir="auto">tarck[i]</code> 的位置信息，如果为负正整数则从后往前取。</strong></p>
<aside aria-label="注意" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>注意</p><section class="starlight-aside__content"><p>下标默认从 <strong><code dir="auto">0</code></strong> 开始，也就是你传递为 0 时，取的是第一条轨道的数据。</p></section></aside>
<p><strong>示例：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 取第一条轨道的位置信息</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">start</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">middle</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">end</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getTrackLocation</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#4C9A91;--1:#2C7181">0</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 取最后一条轨道的位置信息</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">start</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">middle</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">end</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getTrackLocation</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#4C9A91;--1:#2C7181">1</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// 取第一条轨道的位置信息const { start, middle, end } = manager.getTrackLocation(0);// 取最后一条轨道的位置信息const { start, middle, end } = manager.getTrackLocation(-1);"><div></div></button></div></figure></div>
<aside aria-label="提示" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>提示</p><section class="starlight-aside__content"><p>当你发送高级弹幕的时候如果需要将其发送到某条轨道上，此方法可能会很有用。普通弹幕的位置信息计算方式如下，会在轨道的居中的位置渲染，如果要保持和普通弹幕一样，或许也是一样的算法。</p><ol>
<li>对于弹幕的高度，如果你不需要通过计算就可以得到，则不需要通过 <code dir="auto">getHeight()</code> 方法。</li>
<li>你确保获取的轨道存在，否则会报错，可以通过 <code dir="auto">manager.trackCount</code> 来判断。</li>
<li>你可以在我们的在线 <a href="https://imtaotao.github.io/danmu/"><strong>demo</strong></a> 打开浏览器控制台输入这段代码查看效果，</li>
</ol></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 打开控制台后，容器会由变化，需要先调用 `format` 方法重新继续</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">format</span><span style="--0:#8B8B8B;--1:#686868">();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 发送一个高级弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">pushFlexibleDanmaku</span><span style="--0:#8B8B8B;--1:#686868">(</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8B8B8B;--1:#686868">{ </span><span style="--0:#B8A965;--1:#786713">content</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">测试</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868"> },</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">duration</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#4C9A91;--1:#2C7181">5000</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B8A965;--1:#786713">direction</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">none</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#80A665;--1:#4B7231">position</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">, </span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#818F81FE;--1:#636B63">// 渲染在第 4 条轨道中</span></div></div><div class="ec-line highlight mark"><div class="code"><span class="indent">      </span><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">middle</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getTrackLocation</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#4C9A91;--1:#2C7181">3</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#55987B;--1:#1E754F">return</span><span style="--0:#8B8B8B;--1:#686868"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#B8A965;--1:#786713">x</span><span style="--0:#8B8B8B;--1:#686868">: (</span><span style="--0:#BD976A;--1:#876037">container</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">width</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getWidth</span><span style="--0:#8B8B8B;--1:#686868">()) </span><span style="--0:#CB7676;--1:#9E5252">*</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#4C9A91;--1:#2C7181">0.5</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line highlight mark"><div class="code"><span class="indent">        </span><span style="--0:#B8A965;--1:#786713">y</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#BD976A;--1:#876037">middle</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#BD976A;--1:#876037">danmaku</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">getHeight</span><span style="--0:#8B8B8B;--1:#686868">() </span><span style="--0:#CB7676;--1:#9E5252">/</span><span style="--0:#8B8B8B;--1:#686868"> </span><span style="--0:#4C9A91;--1:#2C7181">2</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">      </span></span><span style="--0:#8B8B8B;--1:#686868">};</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">    </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">  </span></span><span style="--0:#8B8B8B;--1:#686868">},</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// 打开控制台后，容器会由变化，需要先调用 &#x60;format&#x60; 方法重新继续manager.format();// 发送一个高级弹幕manager.pushFlexibleDanmaku(  { content: &#x27;测试&#x27; },  {    duration: 5000,    direction: &#x27;none&#x27;,    position(danmaku, container) {      // 渲染在第 4 条轨道中      const { middle } = manager.getTrackLocation(3);      return {        x: (container.width - danmaku.getWidth()) * 0.5,        y: middle - danmaku.getHeight() / 2,      };    },  },);"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="cleartarck"><code dir="auto">clearTarck()</code></h3>
<p><strong>类型：<code dir="auto">(i: number) => void</code></strong></p>
<p>用来清除某条轨道上渲染的弹幕。<strong><code dir="auto">i</code> 如果为正整数，则是清除 <code dir="auto">tarck[i]</code> 上的弹幕，如果为负正整数则从后往前取。</strong></p>
<p><strong>示例：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 清除第一条轨道上的弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">clearTarck</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#4C9A91;--1:#2C7181">0</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 清除最后一条轨道上的弹幕</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">clearTarck</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#CB7676;--1:#9E5252">-</span><span style="--0:#4C9A91;--1:#2C7181">1</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// 清除第一条轨道上的弹幕manager.clearTarck(0);// 清除最后一条轨道上的弹幕manager.clearTarck(-1);"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="len"><code dir="auto">len()</code></h3>
<p><strong>类型：<code dir="auto">() => { stash: number; flexible: number; view: number; all: number }</code></strong></p>
<p>返回当前渲染引擎的弹幕状态数量，这是实时变化的。</p>
<ul>
<li><code dir="auto">all</code> 所有弹幕的数量，包括内存区，渲染中的弹幕。</li>
<li><code dir="auto">view</code> 当前正在渲染的弹幕数量，包含普通弹幕和高级弹幕。</li>
<li><code dir="auto">stash</code> 当前储存在内存区的普通弹幕数量。</li>
<li><code dir="auto">flexible</code> 当前高级弹幕的数量，包含正在渲染的和在内存区的。</li>
</ul>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#8B8B8B;--1:#686868">{</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">stash</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">flexible</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">view</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">all</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">}</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">len</span><span style="--0:#8B8B8B;--1:#686868">();</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const { stash, flexible, view, all } = manager.len();"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="each"><code dir="auto">each()</code></h3>
<p><strong>类型：<code dir="auto">(fn: (d: Danmaku&#x3C;T>) => boolean | void) => void</code></strong></p>
<p>对当前正在渲染的弹幕做<strong>同步遍历</strong>，回调函数返回 <code dir="auto">false</code> 的时候会终止遍历。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="asynceach"><code dir="auto">asyncEach()</code></h3>
<p><strong>类型：<code dir="auto">(fn: (d: Danmaku&#x3C;T>) => boolean | void) => Promise&#x3C;void></code></strong></p>
<p>对当前正在渲染的弹幕做<strong>异步遍历</strong>，回调函数返回 <code dir="auto">false</code> 的时候会终止遍历。</p>
<aside aria-label="与 each 的不同" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>与 <code dir="auto">each</code> 的不同</p><section class="starlight-aside__content"><p><code dir="auto">asyncEach</code> 方法会做时间切片，也就是说当你渲染的弹幕过多时，在遍历的时候由于代码运行时间过长，可能会对主线程造成一定阻塞，所以当有切片之后，则可以缓解这一现象。</p></section></aside>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="mount"><code dir="auto">mount()</code></h3>
<p><strong>类型：<code dir="auto">(node?: HTMLElement | string, { clear?: boolean }) => void</code></strong></p>
<p>将内核的弹幕容器挂载到一个 HTML 节点上，可以是一个 <code dir="auto">string</code> 类型的 <code dir="auto">CSS</code> 选择器，<code dir="auto">clear</code> 参数可以用来清除之前渲染的弹幕，默认为 <code dir="auto">true</code>，如果你不想清除可以传 <code dir="auto">false</code>，挂载之后你可以通过 <code dir="auto">manager.container</code> 拿到这个节点。</p>
<aside aria-label="和内核容器节点的区分" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>和内核容器节点的区分</p><section class="starlight-aside__content"><p>内核容器节点是所有弹幕渲染的节点，包括我们通过 <code dir="auto">manager.setArea()</code> 来调整的时候也是更改的容器节点，但是容器节点<strong>需要挂载到一个具体的 DOM 上</strong>，所以这是他们之间的区分，容器节点的宽高都是 <code dir="auto">100%</code>。</p></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">mount</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">#root</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{ </span><span style="--0:#B8A965;--1:#786713">clear</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#55987B;--1:#1E754F">false</span><span style="--0:#8B8B8B;--1:#686868"> });</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="manager.mount(&#x27;#root&#x27;, { clear: false });"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="unmount"><code dir="auto">unmount()</code></h3>
<p><strong>类型：<code dir="auto">() => void</code></strong></p>
<p>将内核的弹幕容器从当前挂载的节点中卸载，卸载之后当你通过 <code dir="auto">manager.container</code> 获取时会得到 <code dir="auto">null</code>。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">mount</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">#root</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{ </span><span style="--0:#B8A965;--1:#786713">clear</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#55987B;--1:#1E754F">false</span><span style="--0:#8B8B8B;--1:#686868"> });</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="manager.mount(&#x27;#root&#x27;, { clear: false });"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="clear"><code dir="auto">clear()</code></h3>
<p><strong>类型：<code dir="auto">() => void</code></strong></p>
<p>清空当前渲染和内存中的弹幕，会触发 <code dir="auto">clear</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="updateoptions"><code dir="auto">updateOptions()</code></h3>
<p><strong>类型：<code dir="auto">(newOptions: Partial&#x3C;ManagerOptions>) => void</code></strong></p>
<p>更新 <code dir="auto">manager.options</code>，如果涉及到一些间距和宽高的变化，会自动 format，会触发 <code dir="auto">updateOptions</code> 钩子，你可以在这个钩子里面拿到需要更新的 <code dir="auto">options</code>。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="startplaying"><code dir="auto">startPlaying()</code></h3>
<p><strong>类型：<code dir="auto">() => void</code></strong></p>
<p>启动渲染引擎，内核会启动一个定时器轮询渲染。会触发 <code dir="auto">start</code> 钩子</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="stopplaying"><code dir="auto">stopPlaying()</code></h3>
<p><strong>类型：<code dir="auto">() => void</code></strong></p>
<p>关闭渲染引擎，内核的定时器也会被清除。会触发 <code dir="auto">stop</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="hide"><code dir="auto">hide()</code></h3>
<p><strong>类型：<code dir="auto">() => Promise&#x3C;Manager></code></strong></p>
<p>将当前渲染的弹幕隐藏起来，并且新渲染的弹幕也会被隐藏。会触发 <code dir="auto">hide</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="show"><code dir="auto">show()</code></h3>
<p><strong>类型：<code dir="auto">() => Promise&#x3C;Manager></code></strong></p>
<p>将当前被隐藏的弹幕显示出来。会触发 <code dir="auto">show</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="nextframe"><code dir="auto">nextFrame()</code></h3>
<p><strong>类型：<code dir="auto">(fn: FrameRequestCallback) => void</code></strong></p>
<p>这是一个工具方法，回调函数会在下一帧触发。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">nextFrame</span><span style="--0:#8B8B8B;--1:#686868">(()</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">=></span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// ...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">});</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="manager.nextFrame(() => {  // ...});"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="updateoccludedurl"><code dir="auto">updateOccludedUrl()</code></h3>
<p><strong>类型：<code dir="auto">(url?: string, el?: string | HTMLElement) => void</code></strong></p>
<p>给指定元素（默认是当前弹幕容器 <code dir="auto">manager.container.node</code>）添加蒙版，<strong>用来实现防遮挡功能</strong>，如果不传 <code dir="auto">url</code>，代表取消蒙层，你可以通过传递第二参数指定到你需要的 DOM 节点上。</p>
<aside aria-label="注意事项" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>注意事项</p><section class="starlight-aside__content"><p>放遮挡功能需要你不停的调用 <code dir="auto">manager.updateOccludedUrl('url')</code> 来实现蒙层的更新，蒙层照片一般基于业务后端返回（可能是通过 AI 技术来计算当前视频需要防遮挡的区域，实际情况还是要根据业务情况来实现）。</p></section></aside>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="render"><code dir="auto">render()</code></h3>
<p><strong>类型：<code dir="auto">() => void</code></strong></p>
<p>跳过等到下次轮询，立即进行渲染，如果你发送了一个弹幕，不想等待下次轮询，想立即渲染，则可以使用此方法。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">unshift</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">弹幕内容</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 立即渲染</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">render</span><span style="--0:#8B8B8B;--1:#686868">();</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="manager.unshift(&#x27;弹幕内容&#x27;);// 立即渲染manager.render();"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="remove"><code dir="auto">remove()</code></h3>
<p><strong>类型：<code dir="auto">(pluginName: string) => void</code></strong></p>
<p>移除当前 <code dir="auto">manager</code> 实例的某个插件，但是必须指定插件名字。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="use"><code dir="auto">use()</code></h3>
<p><strong>类型：<code dir="auto">(plugin: ManagerPlugin&#x3C;T> | ((m: this) => ManagerPlugin&#x3C;T>)) => ManagerPlugin&#x3C;T> &#x26; { name: string }</code></strong></p>
<p>给当前 <code dir="auto">manager</code> 实例注册一个插件，返回插件实例，如果你在后续需要移除插件，可以保存插件的 <code dir="auto">name</code>，如果不传会默认分别一个 <code dir="auto">uuid</code> 形式的 <code dir="auto">name</code>。</p>
<p><strong>如果传递了 <code dir="auto">name</code>：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">use</span><span style="--0:#8B8B8B;--1:#686868">({</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#B8A965;--1:#786713">name</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">test-plugin</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// ...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">});</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">console</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">log</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">name</span><span style="--0:#8B8B8B;--1:#686868">);</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#818F81FE;--1:#636B63">// 'test-plugin'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const plugin = manager.use({  name: &#x27;test-plugin&#x27;,  // ...});console.log(plugin.name); // &#x27;test-plugin&#x27;"><div></div></button></div></figure></div>
<p><strong>如果不传 <code dir="auto">name</code>：</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">const </span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#8B8B8B;--1:#686868">=</span><span style="--0:#CB7676;--1:#9E5252"> </span><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">use</span><span style="--0:#8B8B8B;--1:#686868">({</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#818F81FE;--1:#636B63">// ...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">});</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">console</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">log</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#BD976A;--1:#876037">plugin</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#BD976A;--1:#876037">name</span><span style="--0:#8B8B8B;--1:#686868">);</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#818F81FE;--1:#636B63">// uuid</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="const plugin = manager.use({  // ...});console.log(plugin.name); // uuid"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="isshow"><code dir="auto">isShow()</code></h3>
<p><strong>类型：<code dir="auto">() => boolean</code></strong></p>
<p>用来判断当前弹幕是否是在 <code dir="auto">显示</code> 状态，通常当你调用 <code dir="auto">manager.show()</code> 之后，调用此方法将会返回 <code dir="auto">true</code>;</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="isfreeze"><code dir="auto">isFreeze()</code></h3>
<p><strong>类型：<code dir="auto">() => boolean</code></strong></p>
<p>用来判断当前弹幕是否是在 <code dir="auto">冻结</code> 状态，通常当你调用 <code dir="auto">manager.freeze()</code> 之后，调用此方法将会返回 <code dir="auto">true</code>;</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="isplaying"><code dir="auto">isPlaying()</code></h3>
<p><strong>类型：<code dir="auto">() => boolean</code></strong></p>
<p>用来判断当前渲染引擎是否正在渲染播放状态，当你调用 <code dir="auto">manager.stopPlaying()</code> 后，会返回 <code dir="auto">false</code>。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="isdanmaku"><code dir="auto">isDanmaku()</code></h3>
<p><strong>类型：<code dir="auto">(b: unknown) => b is Danmaku&#x3C;T></code></strong></p>
<p>用来判断某个值是否是弹幕实例。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setarea"><code dir="auto">setArea()</code></h3>
<p><strong>类型：<code dir="auto">(data: AreaOptions) => void</code></strong></p>
<p>设置当前容器（<code dir="auto">manager.container.node</code>）的大小，会自动 format，使用方法可以参见 <a href="https://github.com/imtaotao/danmu/blob/master/demo/src/components/sidebar/SidebarAreaY.tsx#L26-L31"><strong>demo</strong></a>。</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#CB7676;--1:#9E5252">interface</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#5DA994;--1:#25746A">AreaOptions</span><span style="--0:#DBD7CAEE;--1:#393A34"> </span><span style="--0:#8B8B8B;--1:#686868">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">x</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#BD976A;--1:#876037">start</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#BD976A;--1:#876037">end</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">  </span></span><span style="--0:#8B8B8B;--1:#686868">};</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#BD976A;--1:#876037">y</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#BD976A;--1:#876037">start</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#BD976A;--1:#876037">end</span><span style="--0:#CB7676;--1:#9E5252">?</span><span style="--0:#8B8B8B;--1:#686868">: </span><span style="--0:#5DA994;--1:#25746A">string</span><span style="--0:#8B8B8B;--1:#686868"> | </span><span style="--0:#5DA994;--1:#25746A">number</span><span style="--0:#8B8B8B;--1:#686868">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#8B8B8B;--1:#686868">  </span></span><span style="--0:#8B8B8B;--1:#686868">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#8B8B8B;--1:#686868">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="interface AreaOptions {  x?: {    start?: string | number;    end?: string | number;  };  y?: {    start?: string | number;    end?: string | number;  };}"><div></div></button></div></figure></div>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setopacity"><code dir="auto">setOpacity()</code></h3>
<p><strong>类型：<code dir="auto">(opacity: number | string) => void</code></strong></p>
<p>设置当前弹幕和后续渲染的弹幕的<strong>透明度</strong>，如果参数是 <code dir="auto">string</code>，会默认转为 <code dir="auto">number</code>。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setstyle"><code dir="auto">setStyle()</code></h3>
<p><strong>类型：<code dir="auto">(key: StyleKey, val: CSSStyleDeclaration[StyleKey]) => void</code></strong></p>
<p>设置当前弹幕和后续渲染的弹幕的 <strong>CSS 样式</strong>。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setrate"><code dir="auto">setRate()</code></h3>
<p><strong>类型：<code dir="auto">(rate: number) => void</code></strong></p>
<p>设置后续渲染的弹幕<strong>速率</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setmode"><code dir="auto">setMode()</code></h3>
<p><strong>类型：<code dir="auto">(mode: 'none' | 'strict' | 'adaptive') => void</code></strong></p>
<p>设置后续渲染的弹幕的<strong>碰撞检测算法</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setgap"><code dir="auto">setGap()</code></h3>
<p><strong>类型：<code dir="auto">(gap: number | string) => void</code></strong></p>
<p>设置后续渲染的弹幕之间的<strong>横向间距</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="settimes"><code dir="auto">setTimes()</code></h3>
<p><strong>类型：<code dir="auto">(times: [number, number]) => void</code></strong></p>
<p>设置后续渲染的弹幕之间的<strong>运动时间取值范围</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setlimits"><code dir="auto">setLimits()</code></h3>
<p><strong>类型：<code dir="auto">(limits: { view?: number; stash?: number }) => void</code></strong></p>
<p>设置<strong>要限制的内存区和渲染区域弹幕数量</strong>，默认的 <code dir="auto">stash</code> 数量是 <code dir="auto">1024</code>，如果超过会在控制台发出警告，你可以设置为一个新的值来灵活调整。 是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setinterval"><code dir="auto">setInterval()</code></h3>
<p><strong>类型：<code dir="auto">(interval: number) => void</code></strong></p>
<p>设置渲染引擎的<strong>轮询时间</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="setdirection"><code dir="auto">setDirection()</code></h3>
<p><strong>类型：<code dir="auto">(direction: 'left' | 'right') => void</code></strong></p>
<p>设置后续渲染的<strong>方向</strong>，是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<div style="border-bottom: 0.5px solid var(--sl-color-gray-5); padding: 10px 0"></div>
<h3 id="settrackheight"><code dir="auto">setTrackHeight()</code></h3>
<p><strong>类型：<code dir="auto">(trackHeight: number | string) => void</code></strong></p>
<p>设置<strong>轨道高度</strong>。是 <code dir="auto">manager.updateOptions()</code> 的语法糖，会触发 <code dir="auto">updateOptions</code> 钩子。</p>
<aside aria-label="轨道高度的设置规则" class="starlight-aside starlight-aside--note"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17C12.2652 17 12.5196 16.8946 12.7071 16.7071C12.8946 16.5196 13 16.2652 13 16V12C13 11.7348 12.8946 11.4804 12.7071 11.2929C12.5196 11.1054 12.2652 11 12 11ZM12.38 7.08C12.1365 6.97998 11.8635 6.97998 11.62 7.08C11.4973 7.12759 11.3851 7.19896 11.29 7.29C11.2017 7.3872 11.1306 7.49882 11.08 7.62C11.024 7.73868 10.9966 7.86882 11 8C10.9992 8.13161 11.0245 8.26207 11.0742 8.38391C11.124 8.50574 11.1973 8.61656 11.29 8.71C11.3872 8.79833 11.4988 8.86936 11.62 8.92C11.7715 8.98224 11.936 9.00632 12.099 8.99011C12.2619 8.97391 12.4184 8.91792 12.5547 8.82707C12.691 8.73622 12.8029 8.61328 12.8805 8.46907C12.9582 8.32486 12.9992 8.16378 13 8C12.9963 7.73523 12.8927 7.48163 12.71 7.29C12.6149 7.19896 12.5028 7.12759 12.38 7.08ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z"></path></svg>轨道高度的设置规则</p><section class="starlight-aside__content"><p>轨道高度一般要设置为<strong>大于等于弹幕高度</strong>，否则会有弹幕上下重叠的情况出现。</p></section></aside>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="ts"><code><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 这只会存在三条轨道</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">setTrackHeight</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#C98A7D;--1:#96574A">33%</span><span style="--0:#C98A7DE4;--1:#96574AFD">'</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#818F81FE;--1:#636B63">// 轨道高度为 100px，轨道的数目为 `容器高度 / 100px`</span></div></div><div class="ec-line"><div class="code"><span style="--0:#BD976A;--1:#876037">manager</span><span style="--0:#8B8B8B;--1:#686868">.</span><span style="--0:#80A665;--1:#4B7231">setTrackHeight</span><span style="--0:#8B8B8B;--1:#686868">(</span><span style="--0:#4C9A91;--1:#2C7181">100</span><span style="--0:#8B8B8B;--1:#686868">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// 这只会存在三条轨道manager.setTrackHeight(&#x27;33%&#x27;);// 轨道高度为 100px，轨道的数目为 &#x60;容器高度 / 100px&#x60;manager.setTrackHeight(100);"><div></div></button></div></figure></div> </div> <footer class="sl-flex astro-uarnbp35"> <div class="meta sl-flex astro-uarnbp35"> <a href="https://github.com/imtaotao/danmu/edit/main/docs/src/content/docs/zh/reference/manager-api.mdx" class="sl-flex astro-f3sg7ufl"><svg aria-hidden="true" class="astro-f3sg7ufl astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.2em;"><path d="M22 7.24a1 1 0 0 0-.29-.71l-4.24-4.24a1 1 0 0 0-1.1-.22 1 1 0 0 0-.32.22l-2.83 2.83L2.29 16.05a1 1 0 0 0-.29.71V21a1 1 0 0 0 1 1h4.24a1 1 0 0 0 .76-.29l10.87-10.93L21.71 8c.1-.1.17-.2.22-.33a1 1 0 0 0 0-.24v-.14l.07-.05ZM6.83 20H4v-2.83l9.93-9.93 2.83 2.83L6.83 20ZM18.17 8.66l-2.83-2.83 1.42-1.41 2.82 2.82-1.41 1.42Z"/></svg> 编辑此页</a> <p>最近更新： <time datetime="2024-08-18T13:30:58.000Z">2024年8月18日</time></p> </div> <div class="pagination-links astro-uefck6p2" dir="ltr"><a href="/danmu/document/zh/reference/manager-hooks/" rel="prev" class="astro-uefck6p2"><div class="astro-uefck6p2"><svg aria-hidden="true" class="astro-uefck6p2 astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg> 上一页</div><p class="link-title astro-uefck6p2">全局钩子</p></a><a href="/danmu/document/zh/reference/danmaku-hooks/" rel="next" class="astro-uefck6p2"><div class="astro-uefck6p2">下一页<svg aria-hidden="true" class="astro-uefck6p2 astro-faayp7c7" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg> </div><p class="link-title astro-uefck6p2">弹幕钩子</p></a></div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>